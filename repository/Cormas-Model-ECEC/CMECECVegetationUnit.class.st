Class {
	#name : #CMECECVegetationUnit,
	#superclass : #CMSpatialEntityElement,
	#instVars : [
		'biomass'
	],
	#classInstVars : [
		'K',
		'r',
		'palette'
	],
	#category : #'Cormas-Model-ECEC'
}

{ #category : #accessing }
CMECECVegetationUnit class >> K [
	| tmp2 |
	tmp2 := K.
	^ tmp2 ifNil: [ K := 10 ] ifNotNil: [ tmp2 ]
]

{ #category : #accessing }
CMECECVegetationUnit class >> K: arg1 [
	K := arg1
]

{ #category : #'default value' }
CMECECVegetationUnit class >> K_default [
	^ 10
]

{ #category : #'default value' }
CMECECVegetationUnit class >> biomass_default [
	^ 0
]

{ #category : #testing }
CMECECVegetationUnit class >> isAbstract [
	^ false
]

{ #category : #'default value' }
CMECECVegetationUnit class >> k_default [
	^ 10
]

{ #category : #accessing }
CMECECVegetationUnit class >> r [
	| tmp2 |
	tmp2 := r.
	^ tmp2 ifNil: [ r := 0.2 ] ifNotNil: [ tmp2 ]
]

{ #category : #accessing }
CMECECVegetationUnit class >> r: arg1 [
	r := arg1
]

{ #category : #'default value' }
CMECECVegetationUnit class >> r_default [
	^ 0.2
]

{ #category : #'default value' }
CMECECVegetationUnit class >> state_default [
	^ nil
]

{ #category : #converting }
CMECECVegetationUnit >> asString [
	" Private - See superimplementor's comment "

 	^ String streamContents: [ : stream | 
 		  stream
 			  << super asString;
 				crtab; tab;
 			 	<< 'biomass: ';
 				<< (biomass truncateTo: 0.005) asString ]
]

{ #category : #accessing }
CMECECVegetationUnit >> biomass [
	"Getter accessor with default value = 0.
	!! This method was automatically generated by Cormas !!"
	
	^ biomass ifNil:[biomass := 0]
]

{ #category : #accessing }
CMECECVegetationUnit >> biomass: anObject [
	"Setter accessor of attribute biomass "

	biomass = anObject ifTrue:[^nil].   "for optimization"
	biomass := anObject.
	self changed
]

{ #category : #init }
CMECECVegetationUnit >> initRandomBiomass [
	self biomass: Cormas random
]

{ #category : #printing }
CMECECVegetationUnit >> interestingDetails [
	" Answer a <Collection> of interesting receiver's attributes, from a modeler point of view, to display in a popup for example "

	^ super interestingDetails , { 
		'Biomass' -> ((biomass truncateTo: 0.005) asString)
		}
]

{ #category : #growth }
CMECECVegetationUnit >> logisticGrowth [

	self biomass: (Cormas logisticGrowth: self biomass r: self class r K: self class K)
]

{ #category : #pov }
CMECECVegetationUnit >> povBiomass [
	^ self
		povAttribute: #biomass
		min: 0
		max: self class K
		color: Color green
]

{ #category : #pov }
CMECECVegetationUnit >> povBiomassForager [
	" Answer a Green Color gradient, according to #biomass "
	
	^ self biomass < CMECECForager catabolicRate
		ifTrue: [ Color white ]
		ifFalse: [ self povBiomass ]
]

{ #category : #pov }
CMECECVegetationUnit >> povForagersVision [
	"return a symbol or a ColorValue"
	
	^ (self occupantsType: CMECECForager) isEmpty
		ifFalse: [ self povBiomassForager ]
		ifTrue: [
			self neighbourhood
				detect: [:c | c hasOccupantType: CMECECForager ]
				ifNone: [ ^ Color black].
			self povBiomassForager ]
]

{ #category : #control }
CMECECVegetationUnit >> step [
	self logisticGrowth
]
